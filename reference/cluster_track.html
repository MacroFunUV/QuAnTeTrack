<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Cluster tracks based on movement parameters — cluster_track • QuAnTeTrack</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Cluster tracks based on movement parameters — cluster_track"><meta name="description" content="cluster_track() clusters trajectories based on various movement and velocity parameters calculated for each track."><meta property="og:description" content="cluster_track() clusters trajectories based on various movement and velocity parameters calculated for each track."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">QuAnTeTrack</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/QuAnTeTrack.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/MacroFunUV/QuAnTeTrack/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Cluster tracks based on movement parameters</h1>
      <small class="dont-index">Source: <a href="https://github.com/MacroFunUV/QuAnTeTrack/blob/master/R/cluster_track.R" class="external-link"><code>R/cluster_track.R</code></a></small>
      <div class="d-none name"><code>cluster_track.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>cluster_track()</code> clusters trajectories based on various movement and velocity parameters calculated for each track.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cluster_track</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">veltrack</span>,</span>
<span>  <span class="va">variables</span>,</span>
<span>  analysis <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hclust"</span>, <span class="st">"mclust"</span><span class="op">)</span>,</span>
<span>  k <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  dist_method <span class="op">=</span> <span class="st">"euclidean"</span>,</span>
<span>  hclust_method <span class="op">=</span> <span class="st">"complete"</span>,</span>
<span>  transform <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  scale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  max_clusters <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A <code>track</code> R object, which is a list consisting of two elements:</p><ul><li><p><strong><code>Trajectories</code></strong>: A list of interpolated trajectories, where each trajectory is a series of midpoints between consecutive footprints.</p></li>
<li><p><strong><code>Footprints</code></strong>: A list of data frames containing footprint coordinates, metadata (e.g., image reference, ID), and a marker indicating whether the footprint is actual or inferred.</p></li>
</ul></dd>


<dt id="arg-veltrack">veltrack<a class="anchor" aria-label="anchor" href="#arg-veltrack"></a></dt>
<dd><p>A <code>track velocity</code> R object consisting of a list of lists, where each sublist contains the computed parameters for a corresponding track.</p></dd>


<dt id="arg-variables">variables<a class="anchor" aria-label="anchor" href="#arg-variables"></a></dt>
<dd><p>A character vector specifying the movement parameters to be used in the clustering analysis. Valid parameter names include:
<code>"TurnAng"</code>, <code>"sdTurnAng"</code>, <code>"Distance"</code>, <code>"Length"</code>, <code>"StLength"</code>, <code>"sdStLength"</code>,
<code>"Sinuosity"</code>, <code>"Straightness"</code>, <code>"Velocity"</code>, <code>"sdVelocity"</code>, <code>"MaxVelocity"</code>, <code>"MinVelocity"</code>,
<code>"TrackWidth"</code>, <code>"PaceAng"</code>.</p></dd>


<dt id="arg-analysis">analysis<a class="anchor" aria-label="anchor" href="#arg-analysis"></a></dt>
<dd><p>Character; clustering backend. One of <code>"hclust"</code> (default; distance-based hierarchical clustering)
or <code>"mclust"</code> (model-based Gaussian mixtures).</p></dd>


<dt id="arg-k">k<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>Integer or <code>NULL</code>; number of clusters to cut the dendrogram when <code>analysis = "hclust"</code>.
Default <code>2</code>. If <code>NULL</code>, no cut is made and <code>classification</code> is returned as <code>NULL</code>.</p></dd>


<dt id="arg-dist-method">dist_method<a class="anchor" aria-label="anchor" href="#arg-dist-method"></a></dt>
<dd><p>Character; distance used when <code>analysis = "hclust"</code>.
One of <code>"euclidean"</code> (default), <code>"maximum"</code>, <code>"manhattan"</code>, <code>"canberra"</code>,
<code>"binary"</code>, or <code>"minkowski"</code>.</p></dd>


<dt id="arg-hclust-method">hclust_method<a class="anchor" aria-label="anchor" href="#arg-hclust-method"></a></dt>
<dd><p>Character; agglomeration method when <code>analysis = "hclust"</code>.
One of  <code>"complete"</code> (default), <code>"ward.D"</code>, <code>"ward.D2"</code>, <code>"single"</code>,
<code>"average"</code> (= UPGMA), <code>"mcquitty"</code> (= WPGMA), <code>"median"</code> (= WPGMC), or <code>"centroid"</code> (= UPGMC).</p></dd>


<dt id="arg-transform">transform<a class="anchor" aria-label="anchor" href="#arg-transform"></a></dt>
<dd><p>Logical; if <code>TRUE</code> (default), applies monotone transformations suited to variable support
(e.g., log/logit) before clustering.</p></dd>


<dt id="arg-scale">scale<a class="anchor" aria-label="anchor" href="#arg-scale"></a></dt>
<dd><p>Logical; if <code>TRUE</code> (default), z-transforms (centers and scales) the variables used in clustering.</p></dd>


<dt id="arg-max-clusters">max_clusters<a class="anchor" aria-label="anchor" href="#arg-max-clusters"></a></dt>
<dd><p>Integer. Maximum number of clusters (mixture components) to consider when <code>analysis = "mclust"</code>.
If <code>NULL</code> (default), uses <code>min(9, n)</code>, where <code>n</code> is the number of valid tracks (observations) entering the model.
The minimum number of clusters considered by default is <code>1</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A track clustering R object consisting of a list containing the following elements:</p><ul><li><p><code>matrix</code>: A data frame containing the movement parameters calculated for each track
(original scale/units as produced by <code><a href="track_param.html">track_param()</a></code> and <code><a href="velocity_track.html">velocity_track()</a></code>).</p></li>
<li><p><code>clust</code>:</p><ul><li><p>When <code>analysis = "hclust"</code>: a list with:</p><ul><li><p><code>hclust</code>: The <code><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">stats::hclust</a></code> object (dendrogram and merge history).</p></li>
<li><p><code>dist</code>: The <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">stats::dist</a></code> object used to fit <code>hclust</code>.</p></li>
<li><p><code>k</code>: The requested number of clusters used to cut the tree (if provided).</p></li>
<li><p><code>classification</code>: Cluster labels obtained by <code>stats::cutree(hclust, k)</code>; <code>NULL</code> if <code>k = NULL</code>.</p></li>
</ul></li>
<li><p>When <code>analysis = "mclust"</code>: an <code>Mclust</code> object containing the results of the
model-based clustering analysis (optimal model selected by BIC). Main components include:</p><ul><li><p><code>call</code>: The matched call.</p></li>
<li><p><code>data</code>: The input data matrix used by <code>Mclust</code>.</p></li>
<li><p><code>modelName</code>: The covariance model at which the optimal BIC occurs.</p></li>
<li><p><code>n</code>: Number of observations.</p></li>
<li><p><code>d</code>: Data dimensionality.</p></li>
<li><p><code>G</code>: Optimal number of mixture components.</p></li>
<li><p><code>BIC</code>: Matrix of BIC values for models and components considered.</p></li>
<li><p><code>loglik</code>: Log-likelihood for the selected model.</p></li>
<li><p><code>df</code>: Number of estimated parameters.</p></li>
<li><p><code>bic</code>: BIC value of the selected model.</p></li>
<li><p><code>icl</code>: ICL value of the selected model.</p></li>
<li><p><code>hypvol</code>: Hypervolume parameter for the noise component (if applicable), otherwise <code>NULL</code>.</p></li>
<li><p><code>parameters</code>: List of fitted parameters, including:</p><ul><li><p><code>pro</code>: Mixing proportions (length <code>G</code>).</p></li>
<li><p><code>mean</code>: Component means (vector or matrix with columns as components).</p></li>
<li><p><code>variance</code>: List of variance parameters (structure depends on <code>modelName</code>).</p></li>
</ul></li>
<li><p><code>z</code>: Matrix of posterior probabilities; entry <code>(i, k)</code> is P(observation <code>i</code> in class <code>k</code>).</p></li>
<li><p><code>classification</code>: Hard labels (MAP from <code>z</code>).</p></li>
<li><p><code>uncertainty</code>: Classification uncertainty for each observation.</p></li>
</ul></li>
</ul></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <code>cluster_track()</code> function can perform distance-based hierarchical clustering via the <code><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust()</a></code> function from the <span class="pkg">stats</span> package (<code>analysis = "hclust"</code>, default) or model-based clustering via the <code>Mclust()</code> function from the <span class="pkg">mclust</span> package
(<code>analysis = "mclust"</code>).</p>
<p>The function first filters out tracks with fewer than four steps, as these tracks may not provide reliable movement data.
It then calculates various movement parameters for each remaining track, including turning angles, distances, lengths, sinuosity, straightness, velocities,
and additional ichnological descriptors (trackway width, pace angulation).
Finally, the selected movement parameters are used as input for clustering the tracks.</p>
<p>When <code>analysis = "hclust"</code>: the function performs agglomerative hierarchical clustering
on a pairwise dissimilarity matrix computed from the working feature matrix (which already reflects the
internal expansion of circular variables to sine/cosine components, and any requested transformations and
z-scaling).</p>
<p>The algorithm starts with each track as its own cluster and iteratively merges the two closest clusters
according to the chosen <code>hclust_method</code> (linkage criterion) until a single cluster remains. The full
merge history is represented by a dendrogram that can be inspected and cut at any desired number of clusters.</p>
<p>Advantages include being distribution-free, since the method does not assume Gaussianity or any parametric mixture form.
It is also flexible, supporting multiple distance metrics, and highly interpretable, as the dendrogram reveals
multiscale clustering structure. In addition, the number of clusters does not need to be fixed in advance,
since it can be chosen a posteriori by cutting the tree. Disadvantages are that
the greedy nature of the algorithm makes merges irreversible, so no reassignment
is possible once clusters are combined. Results can also be sensitive to variable scaling, as well as the
choice of distance metric and linkage method. Certain linkage strategies, such as <code>"median"</code> or
<code>"centroid"</code>, may produce dendrogram inversions, and the <code>"ward.*"</code> methods require Euclidean
geometry to preserve their variance-minimization interpretation.</p>
<p>If <code>transform = TRUE</code> and/or <code>scale = TRUE</code>, the distance is computed on the
transformed/scaled space. This is generally recommended so that variables on different scales do not dominate the
distances. Missing values in the selected variables will cause <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">stats::dist()</a></code> to fail; ensure inputs are
complete (or impute externally) before clustering.</p>
<p>The argument <code>k</code> controls the number of clusters to cut the dendrogram. By default it is set to <code>2</code>.
If <code>NULL</code>, no cut is made and <code>classification</code> is returned as <code>NULL</code>. Setting <code>k = 1</code>
yields a single cluster containing all tracks.</p>
<p>The argument <code>dist_method</code> specifies the distance metric used to build the dissimilarity matrix,
passed to <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">stats::dist</a></code>. For a detailed explanation of distance metrics see <code><a href="https://rdrr.io/r/stats/dist.html" class="external-link">?dist</a></code>.</p>
<p>The argument <code>hclust_method</code> specifies the agglomeration (linkage) method used for hierarchical clustering,
passed to <code><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">stats::hclust</a></code>. For a detailed explanation of linkage procedures see <code><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">?hclust</a></code>.</p>
<p>When <code>analysis = "mclust"</code>, clustering is performed using finite Gaussian mixture models
via the <code>Mclust()</code> function from the <span class="pkg">mclust</span> package.
This approach assumes that the data are generated from a mixture of multivariate Gaussian distributions,
and selects both the number of mixture components and the covariance parameterization by optimizing
the Bayesian Information Criterion (BIC).</p>
<p>Advantages include statistical rigor, automatic model selection, and the ability to capture ellipsoidal
cluster shapes. Limitations are the reliance on distributional assumptions (normality, homoscedasticity
depending on the model), potential sensitivity to outliers, and increased computational cost for
high-dimensional data. These assumptions are partially mitigated by the variable transformations
applied before clustering (e.g., log or logit transforms), which help approximate Gaussian-like
distributions.</p>
<p>If only one parameter is selected, the clustering is performed using equal variance ("E") and variable
variance ("V") Gaussian models. If more than one parameter is selected, all covariance models available
in <code>mclust.options("emModelNames")</code> are considered.</p>
<p>The argument <code>max_clusters</code> controls the maximum number of clusters (mixture components) to be explored.
If <code>NULL</code> (default), the maximum is set to <code>min(9, n)</code>, where <code>n</code> is the number of valid tracks
(observations) entering the model. The minimum number of clusters considered by default is <code>1</code>.</p>
<p>The following movement parameters can be included in the clustering:</p><ul><li><p><code>"TurnAng"</code>: Turning angles for the track, measured in degrees. Internally expanded to
sine and cosine components (circular treatment) before analysis. This measures how much the
direction of movement changes at each step.</p></li>
<li><p><code>"sdTurnAng"</code>: The circular standard deviation of the turning angles, in degrees.
Internally expanded to sine and cosine components before analysis to respect angular geometry.</p></li>
<li><p><code>"Distance"</code>: The total distance covered by the track, calculated as the sum of the
straight-line distances between consecutive points (meters).</p></li>
<li><p><code>"Length"</code>: The overall length of the track, a straight-line distance between the
starting and ending points (meters).</p></li>
<li><p><code>"StLength"</code>: Step lengths for each step of the track, representing how far the object
moved between two consecutive points (meters).</p></li>
<li><p><code>"sdStLength"</code>: The standard deviation of the step lengths, showing how consistent the
steps are in length (meters).</p></li>
<li><p><code>"Sinuosity"</code>: A measure of the track's winding nature, calculated as the ratio of the
actual track length to the straight-line distance (dimensionless).</p></li>
<li><p><code>"Straightness"</code>: The straightness of the track, calculated as the straight-line
distance divided by the total path length (dimensionless).</p></li>
<li><p><code>"Velocity"</code>: The average velocity of the track, calculated as the total distance divided
by the time elapsed between the first and last footprint (meters per second).</p></li>
<li><p><code>"sdVelocity"</code>: The standard deviation of the velocity, indicating how much the velocity
fluctuates throughout the track (meters per second).</p></li>
<li><p><code>"MaxVelocity"</code>: The maximum velocity achieved during the track, identifying the fastest
point (meters per second).</p></li>
<li><p><code>"MinVelocity"</code>: The minimum velocity during the track, identifying the slowest point
(meters per second).</p></li>
<li><p><code>"TrackWidth"</code>: Trackway width, i.e., the lateral spacing between left and right
footprint series (units consistent with input coordinates, typically meters).</p></li>
<li><p><code>"PaceAng"</code>: Pace angulation (degrees), a classical ichnological descriptor summarizing
the angular relation of successive steps within a trackway.</p></li>
</ul><p>The <code>cluster_track()</code> function has biological relevance in identifying groups of tracks with
similar movement parameters, providing insights into ecological and behavioral patterns. By
clustering tracks based on characteristics such as sinuosity, velocity, and turning angles (treated
circularly via sine/cosine), it helps detect movement patterns associated with specific behaviors.
This can reveal tracks potentially made by individuals moving together, useful for investigating
hypotheses on gregarious behavior, predation strategies, or coordinated movement. Additionally,
clustering serves as a preliminary step before similarity tests and simulations, refining track
selection and improving hypothesis testing in movement ecology studies.</p>
    </div>
    <div class="section level2">
    <h2 id="logo">Logo<a class="anchor" aria-label="anchor" href="#logo"></a></h2>


<p><img src="figures/Logo.png" width="120"></p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Alexander, R. M. (1976). Estimates of speeds of dinosaurs. Nature, 261(5556), 129-130.</p>
<p>Ruiz, J., &amp; Torices, A. (2013). Humans running at stadiums and beaches and the accuracy of speed estimations from fossil trackways. Ichnos, 20(1), 31-35.</p>
<p>Scrucca L., Fop M., Murphy T. B., &amp; Raftery A. E. (2016) mclust 5: clustering, classification and density estimation using Gaussian finite mixture models. The R Journal, 8(1), 289-317.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="track_param.html">track_param</a></code>, <code><a href="velocity_track.html">velocity_track</a></code>, <code><a href="https://mclust-org.github.io/mclust/reference/Mclust.html" class="external-link">Mclust</a></code>, <code><a href="https://rdrr.io/r/stats/hclust.html" class="external-link">hclust</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Humberto G. Ferrón</p>
<p>humberto.ferron@uv.es</p>
<p>Macroevolution and Functional Morphology Research Group (www.macrofun.es)</p>
<p>Cavanilles Institute of Biodiversity and Evolutionary Biology</p>
<p>Calle Catedrático José Beltrán Martínez, nº 2</p>
<p>46980 Paterna - Valencia - Spain</p>
<p>Phone: +34 (9635) 44477</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Humberto G Ferrón.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

