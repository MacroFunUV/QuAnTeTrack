---
title: "QuAnTeTrack"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{QuAnTeTrack}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(QuAnTeTrack)
```

This vignette demonstrates how to **load, process, and analyze trackway data** using the **QuAnTeTrack** package. We will walk through two datasets:

- **Paluxy River Dataset:** Tracks without missing footprints. This dataset represents dinosaur tracks from the Paluxy River site, described by Farlow et al. (2012). The dataset includes interpolated trajectories and footprint coordinates with metadata indicating whether each footprint is actual or inferred.  
  **Source:** *Farlow, J. O., O’Brien, M., Kuban, G. J., Dattilo, B. F., Bates, K. T., Falkingham, P. L., & Piñuela, L. (2012). Dinosaur Tracksites of the Paluxy River Valley (Glen Rose Formation, Lower Cretaceous), Dinosaur Valley State Park, Somervell County, Texas. In Proceedings of the V International Symposium about Dinosaur Palaeontology and their Environment (pp. 41-69). Burgos: Salas de los Infantes.*

- **Mount Tom Dataset:** Tracks with missing footprints. This dataset is based on dinosaur tracks from the Mount Tom site, originally described by Ostrom (1972). It includes interpolated trajectories and footprint coordinates, with markers indicating actual and inferred footprints.  
  **Source:** *Ostrom, J. H. (1972). Were some dinosaurs gregarious? Palaeogeography, Palaeoclimatology, Palaeoecology, 11(4), 287-301.*

We will use the **QuAnTeTrack** functions to load the data, process the track objects, visualize the tracks, and analyze movement parameters such as velocities and step directions.  

---

## **Example 1: Paluxy River Dataset**

**Step 1:** **Loading and Converting Data**

This example demonstrates how to load, process, and analyze trackway data from the Paluxy River Dataset, which includes tracks without missing footprints.

Step 1: Loading and Converting Data
The TPS file (PaluxyRiver.tps) is loaded using the `system.file()` function to ensure compatibility across systems. It is then converted to a track object using the `tps_to_track()` function. The scale argument is used to set the coordinate scaling factor. Since no footprints are missing, the missing argument is set to `FALSE` and `NAs = NULL`.

```{r, eval=FALSE}
tpsPaluxyRiver <- system.file("extdata", "PaluxyRiver.tps", package = "QuAnTeTrack")
PaluxyRiver <- tps_to_track(tpsPaluxyRiver, scale = 0.004341493, missing = FALSE, NAs = NULL)
```

Plot with defauts
```{r echo=TRUE}
plot_track(PaluxyRiver)
```

Plot Footprints Only
```{r echo=TRUE}
plot_track(PaluxyRiver, plot = "Footprints")
```

Extract extract parameters
```{r echo=TRUE}
params_paluxy <- track_param(PaluxyRiver)
```

Boxplot of Direction Data
```{r echo=TRUE, results='hide'}
plot_direction(PaluxyRiver, plot_type = "boxplot")
```

Polar Plot of Step Directions
```{r echo=TRUE, results='hide'}
plot_direction(PaluxyRiver, plot_type = "polar_steps")
```


Polar Plot of Average Directions Per Track with Custom Breaks
```{r echo=TRUE, results='hide'}
plot_direction(PaluxyRiver,
plot_type = "polar_average",
y_breaks_manual = c(1, 2)
)
```


Faceted Polar Plot of Step Directions
```{r echo=TRUE, results='hide'}
plot_direction(PaluxyRiver, plot_type = "faceted")
```


Polar Plot of Average Directions Per Track with Custom Breaks
```{r echo=TRUE, results='hide'}
plot_direction(PaluxyRiver,
plot_type = "polar_average",
y_breaks_manual = c(1, 2)
)
```


Polar Plot with Custom Y-Axis Labels
```{r echo=TRUE, results='hide'}
plot_direction(PaluxyRiver,
plot_type = "polar_steps",
y_labels_position = -90
)
```



```{r, echo=TRUE, message=FALSE}
H_paluxyriver <- c(3.472, 2.200)
Method_paluxyriver <- c("A", "B")
velocity_paluxyriver <- velocity_track(PaluxyRiver, H = H_paluxyriver, method = Method_paluxyriver)
```


**Example 2: Mount Tom Dataset**

tpsMountTom <- system.file("extdata", "MountTom.tps", package = "QuAnTeTrack")
NAs <- matrix(c(7, 3), nrow = 1, ncol = 2)
MountTom <- tps_to_track(tpsMountTom, scale = 0.004411765, missing = TRUE, NAs = NAs,
                         R.L.side = c("R", "L", "L", "L", "R", "L", "R", "R", "L", "L", 
                                      "L", "L", "L", "R", "R", "L", "R", "R", "L", "R", 
                                      "R", "R", "R"))
plot_track(MountTom)

Display track parameters within a scrollable box
params_mounttom <- track_param(MountTom)
print(params_mounttom)

plot_direction(MountTom, plot_type = "polar_steps")

H_mounttom <- c(1.380, 1.404, 1.320, 1.736, 1.364, 1.432, 1.508, 1.768, 1.600, 1.848, 
                1.532, 1.532, 0.760, 1.532, 1.688, 1.620, 0.636, 1.784, 1.676, 1.872, 
                1.648, 1.760, 1.612)
velocity_mounttom <- velocity_track(MountTom, H = H_mounttom)
print(velocity_mounttom)


