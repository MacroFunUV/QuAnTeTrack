<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Partition anatomical-fidelity uncertainty (simulation-based) — anatomical_error_partitioning • QuAnTeTrack</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Partition anatomical-fidelity uncertainty (simulation-based) — anatomical_error_partitioning"><meta name="description" content="anatomical_error_partitioning() quantifies how much variance in trackway parameters
is due to track landmark placement uncertainty (degree of anatomical fidelity) versus genuine
between-track (biological) differences, using simulation only (no observer effects)."><meta property="og:description" content="anatomical_error_partitioning() quantifies how much variance in trackway parameters
is due to track landmark placement uncertainty (degree of anatomical fidelity) versus genuine
between-track (biological) differences, using simulation only (no observer effects)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">QuAnTeTrack</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/QuAnTeTrack.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/MacroFunUV/QuAnTeTrack/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Partition anatomical-fidelity uncertainty (simulation-based)</h1>
      <small class="dont-index">Source: <a href="https://github.com/MacroFunUV/QuAnTeTrack/blob/master/R/anatomical_error_partitioning.R" class="external-link"><code>R/anatomical_error_partitioning.R</code></a></small>
      <div class="d-none name"><code>anatomical_error_partitioning.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>anatomical_error_partitioning()</code> quantifies how much variance in trackway parameters
is due to track landmark placement uncertainty (degree of anatomical fidelity) versus genuine
between-track (biological) differences, using simulation only (no observer effects).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">anatomical_error_partitioning</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">error_radius</span>,</span>
<span>  variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TurnAng"</span>, <span class="st">"sdTurnAng"</span>, <span class="st">"Distance"</span>, <span class="st">"Length"</span>, <span class="st">"StLength"</span>, <span class="st">"sdStLength"</span>,</span>
<span>    <span class="st">"Sinuosity"</span>, <span class="st">"Straightness"</span>, <span class="st">"TrackWidth"</span>, <span class="st">"PaceAng"</span><span class="op">)</span>,</span>
<span>  n_sim <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  distribution <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"uniform"</span>, <span class="st">"gaussian"</span><span class="op">)</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A <code>track</code> R object, which is a list consisting of two elements:</p><ul><li><p><strong><code>Trajectories</code></strong>: A list of interpolated trajectories, where each trajectory is a series of midpoints between consecutive tracks.</p></li>
<li><p><strong><code>tracks</code></strong>: A list of data frames containing track coordinates, metadata (e.g., image reference, ID), and a marker indicating whether the track is actual or inferred.</p></li>
</ul></dd>


<dt id="arg-error-radius">error_radius<a class="anchor" aria-label="anchor" href="#arg-error-radius"></a></dt>
<dd><p>Numeric; single radius (m) applied to all tracks or a numeric vector of length
<code>length(data$tracks)</code> with per-track tolerances.</p></dd>


<dt id="arg-variables">variables<a class="anchor" aria-label="anchor" href="#arg-variables"></a></dt>
<dd><p>A character vector of parameters to analyze. Default is
<code>c("TurnAng","sdTurnAng","Distance","Length","StLength","sdStLength",
          "Sinuosity","Straightness","TrackWidth","PaceAng")</code>.</p></dd>


<dt id="arg-n-sim">n_sim<a class="anchor" aria-label="anchor" href="#arg-n-sim"></a></dt>
<dd><p>Integer; number of Monte Carlo jitter simulations per track. Default is <code>200</code>.</p></dd>


<dt id="arg-distribution">distribution<a class="anchor" aria-label="anchor" href="#arg-distribution"></a></dt>
<dd><p>A character string indicating the jitter model. Options are
<code>"uniform"</code> (points uniformly within a disk of radius r; default) or
<code>"gaussian"</code> (SD = r/2 on X and Y, truncated at 3 SD).</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>Optional integer for reproducibility. Default is <code>NULL</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An <code>"error_partitioning"</code> R object consisting of a list
containing the following elements:</p>
<dl><dt>summary</dt>
<dd><p>Data frame of variance components per variable.
Columns: <code>variable</code>, <code>component</code>, <code>variance</code>,
<code>percent</code>, and \(R^2_c\). Components are <code>track</code>
(biological), <code>anatomical</code> (within-track simulation variance),
and <code>Residual</code> (from the model on simulation means).</p></dd>


<dt>snr</dt>
<dd><p>Data frame with the signal-to-noise ratio per variable.
Columns: <code>variable</code>, <code>bio_component</code> (always <code>"track"</code>),
<code>bio_var</code>, <code>error_var</code>, and <code>SNR</code>. The ratio is
$$SNR = Var(track) / [Var(anatomical) + Var(Residual)].$$</p></dd>


<dt>qc</dt>
<dd><p>Compact quality-control table per variable with <code>SNR</code>,
a qualitative <code>SNR_rating</code> (<code>"weak"</code>, <code>"moderate"</code>,
<code>"strong"</code>), the <code>top_component</code> by percent, its
<code>top_percent</code>, \(R^2_c\), and an <code>observer_note</code>
(always <code>"anatomical-only"</code> for this function).</p></dd>


<dt>models</dt>
<dd><p><code>NULL</code>. Placeholder kept for consistency with the
observer-inclusive workflow. No observer models are fitted here.</p></dd>


<dt>analysis_table</dt>
<dd><p>Long data frame with all simulated values for
every track across all Monte Carlo runs (variables joined with track
IDs and simulation labels).</p></dd>


<dt>formulae</dt>
<dd><p>A short note describing the simulation-only
decomposition (within-track anatomical variance from simulations,
plus a random-intercept model on simulation means:
\(y \sim 1 + (1|track)\); angles handled via sine–cosine).</p></dd>


<dt>track_names</dt>
<dd><p>Character vector of internal track labels used in
the analysis.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function estimates how much of the variability in trackway metrics can be
attributed to positional uncertainty in track landmarks, rather than to true
biological differences among trackways. It asks, in essence: "If landmarks
were slightly misplaced by up to <code>error_radius</code>, how much would that
affect our computed parameters?" For each trackway, landmarks are repeatedly
perturbed within the specified spatial tolerance, the medial trajectory is
reconstructed, and parameters are recalculated across Monte Carlo simulations.
The resulting variance in each metric is then decomposed into a between-track
component (biological signal) and a within-track component (anatomical noise).</p>
<p>The <code>error_radius</code> represents expected imprecision in reference-point
digitization (e.g., preservation quality, erosion, deformation, or subjective
landmark interpretation). By specifying a realistic tolerance, users can
evaluate how sensitive each metric is to anatomical or taphonomic uncertainty
and identify parameters that remain stable despite imperfect preservation.</p>
<p>For every track and simulation, landmarks are randomly
displaced within a circular area of radius <code>r</code>, using either a uniform
model (<code>"uniform"</code>) or a truncated Gaussian on <code>X</code> and <code>Y</code>
with <code>SD = r/2</code> (<code>"gaussian"</code>, truncated at ±3 SD). Each perturbed
landmark set is converted to a medial trajectory (midpoints between
consecutive footprints, as in <code><a href="tps_to_track.html">tps_to_track()</a></code>), and parameters are
recalculated via <code><a href="track_param.html">track_param()</a></code>. For each metric \(Y\), total
variance is partitioned via the law of total variance into:</p><ul><li><p><strong>track (biological)</strong> — variance of simulation means among tracks;</p></li>
<li><p><strong>anatomical</strong> — mean of within-track variances across simulations;</p></li>
<li><p><strong>Residual</strong> — residual from the random-intercept model on
simulation means (no observer terms in this simulation-only setup).</p></li>
</ul><p>Angular variables (<code>TurnAng</code>, <code>PaceAng</code>) are embedded in sine–cosine
space to handle circularity and avoid 0°/360° discontinuities (Fisher, 1995).</p>
<p>A signal-to-noise ratio quantifies robustness:
$$\mathrm{SNR} = \frac{\mathrm{Var}(\mathrm{track})}
                {\mathrm{Var}(\mathrm{anatomical}) + \mathrm{Var}(\mathrm{Residual})}.$$
As a rule of thumb:</p><ul><li><p><strong>SNR &lt; 1</strong> — anatomical error exceeds biology (weak);</p></li>
<li><p><strong>SNR ~ 1–2</strong> — biology and anatomical error are comparable (moderate);</p></li>
<li><p><strong>SNR &gt; 2</strong> — biology dominates (strong).</p></li>
</ul><p>A compact QC table reports SNR, the qualitative rating, the top component by
percent, and the conditional \(R^2_c\).</p>
    </div>
    <div class="section level2">
    <h2 id="logo">Logo<a class="anchor" aria-label="anchor" href="#logo"></a></h2>


<p><img src="figures/Logo.png" width="120"></p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Fisher, N. I. (1995). Statistical Analysis of Circular Data. Cambridge University Press.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="tps_to_track.html">tps_to_track</a></code>, <code><a href="track_param.html">track_param</a></code>, <code><a href="subset_track.html">subset_track</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Humberto G. Ferrón</p>
<p>humberto.ferron@uv.es</p>
<p>Macroevolution and Functional Morphology Research Group (www.macrofun.es)</p>
<p>Cavanilles Institute of Biodiversity and Evolutionary Biology</p>
<p>Calle Catedrático José Beltrán Martínez, nº 2</p>
<p>46980 Paterna - Valencia - Spain</p>
<p>Phone: +34 (9635) 44477</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Example 1: PaluxyRiver, small jitter (2 cm), uniform noise</span></span></span>
<span class="r-in"><span><span class="co"># Expect relatively stable metrics and higher SNR.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ep_small</span> <span class="op">&lt;-</span> <span class="fu">anatomical_error_partitioning</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data         <span class="op">=</span> <span class="va">PaluxyRiver</span>,</span></span>
<span class="r-in"><span>  error_radius <span class="op">=</span> <span class="fl">0.02</span>,</span></span>
<span class="r-in"><span>  variables    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Distance"</span>, <span class="st">"Straightness"</span>, <span class="st">"TurnAng"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  n_sim        <span class="op">=</span> <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ep_small</span><span class="op">$</span><span class="va">qc</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       variable        SNR SNR_rating top_component top_percent      R2_c</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     Distance 2734.80404     strong         track    99.96345 0.9996345</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Straightness   22.61413     strong         track    95.76525 0.9576525</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      TurnAng 1471.30665     strong         track    99.93208 0.9993208</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                observer_estimable</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 no (anatomical-only, sim-based)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 no (anatomical-only, sim-based)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 no (anatomical-only, sim-based)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 2: PaluxyRiver, larger jitter (8 cm) to see SNR drop</span></span></span>
<span class="r-in"><span><span class="co"># Inflate anatomical uncertainty; SNR should typically decrease.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ep_large</span> <span class="op">&lt;-</span> <span class="fu">anatomical_error_partitioning</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data         <span class="op">=</span> <span class="va">PaluxyRiver</span>,</span></span>
<span class="r-in"><span>  error_radius <span class="op">=</span> <span class="fl">0.08</span>,</span></span>
<span class="r-in"><span>  variables    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Distance"</span>, <span class="st">"Straightness"</span>, <span class="st">"TurnAng"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  n_sim        <span class="op">=</span> <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ep_large</span><span class="op">$</span><span class="va">qc</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       variable        SNR SNR_rating top_component top_percent      R2_c</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     Distance 165.040390     strong         track    99.39774 0.9939774</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 Straightness   2.187696     strong         track    68.62938 0.6862938</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3      TurnAng  90.802197     strong         track    98.91070 0.9891070</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                observer_estimable</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 no (anatomical-only, sim-based)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 no (anatomical-only, sim-based)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 no (anatomical-only, sim-based)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 3: MountTom subset + Gaussian jitter (3 cm, truncated at ±3 SD)</span></span></span>
<span class="r-in"><span><span class="co"># Demonstrates alternative noise model and a reduced dataset.</span></span></span>
<span class="r-in"><span><span class="va">sbMountTom</span> <span class="op">&lt;-</span> <span class="fu"><a href="subset_track.html">subset_track</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">MountTom</span>,</span></span>
<span class="r-in"><span>  tracks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">7</span>, <span class="fl">8</span>, <span class="fl">9</span>, <span class="fl">13</span>, <span class="fl">15</span>, <span class="fl">16</span>, <span class="fl">18</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ep_gauss</span> <span class="op">&lt;-</span> <span class="fu">anatomical_error_partitioning</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data         <span class="op">=</span> <span class="va">sbMountTom</span>,</span></span>
<span class="r-in"><span>  error_radius <span class="op">=</span> <span class="fl">0.03</span>,</span></span>
<span class="r-in"><span>  variables    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"StLength"</span>, <span class="st">"sdStLength"</span>, <span class="st">"PaceAng"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  n_sim        <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>  distribution <span class="op">=</span> <span class="st">"gaussian"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ep_gauss</span><span class="op">$</span><span class="va">snr</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              variable bio_component     bio_var    error_var        SNR</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> StLength     StLength         track 0.058217558 1.031312e-05 5644.99846</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sdStLength sdStLength         track 0.001165249 2.973018e-05   39.19415</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PaceAng       PaceAng         track 0.005343677 2.543369e-04   21.01023</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 4: PaluxyRiver with heterogeneous per-track tolerances</span></span></span>
<span class="r-in"><span><span class="co"># Alternate 2 cm / 5 cm across tracks; highlights mixed preservation quality.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rads</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.02</span>, <span class="fl">0.05</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>            length.out <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">PaluxyRiver</span><span class="op">$</span><span class="va">Footprints</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ep_het</span> <span class="op">&lt;-</span> <span class="fu">anatomical_error_partitioning</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data         <span class="op">=</span> <span class="va">PaluxyRiver</span>,</span></span>
<span class="r-in"><span>  error_radius <span class="op">=</span> <span class="va">rads</span>,</span></span>
<span class="r-in"><span>  variables    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TrackWidth"</span>, <span class="st">"Sinuosity"</span>, <span class="st">"PaceAng"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  n_sim        <span class="op">=</span> <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ep_het</span><span class="op">$</span><span class="va">summary</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                variable  component     variance    percent      R2_c</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TrackWidth.1 TrackWidth      track 3.740549e-02 99.7499311 0.9974993</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TrackWidth.2 TrackWidth anatomical 9.377402e-05  0.2500689 0.9974993</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TrackWidth.3 TrackWidth   Residual 0.000000e+00  0.0000000 0.9974993</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sinuosity.1   Sinuosity      track 3.086845e-03 98.6831363 0.9868314</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sinuosity.2   Sinuosity anatomical 4.119198e-05  1.3168637 0.9868314</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sinuosity.3   Sinuosity   Residual 0.000000e+00  0.0000000 0.9868314</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PaceAng.1       PaceAng      track 8.498442e-02 99.7797710 0.9977977</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PaceAng.2       PaceAng anatomical 1.875734e-04  0.2202290 0.9977977</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PaceAng.3       PaceAng   Residual 0.000000e+00  0.0000000 0.9977977</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 5: Angles only (circular handling via sine–cosine embedding)</span></span></span>
<span class="r-in"><span><span class="co"># Focus on orientation metrics; output includes averaged sin/cos components.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ep_ang</span> <span class="op">&lt;-</span> <span class="fu">anatomical_error_partitioning</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data         <span class="op">=</span> <span class="va">PaluxyRiver</span>,</span></span>
<span class="r-in"><span>  error_radius <span class="op">=</span> <span class="fl">0.04</span>,</span></span>
<span class="r-in"><span>  variables    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"TurnAng"</span>, <span class="st">"PaceAng"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  n_sim        <span class="op">=</span> <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ep_ang</span><span class="op">$</span><span class="va">summary</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           variable  component     variance    percent      R2_c</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TurnAng.1  TurnAng      track 4.283363e-04 99.8192789 0.9981928</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TurnAng.2  TurnAng anatomical 7.754955e-07  0.1807211 0.9981928</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TurnAng.3  TurnAng   Residual 0.000000e+00  0.0000000 0.9981928</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PaceAng.1  PaceAng      track 8.475987e-02 99.7051248 0.9970512</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PaceAng.2  PaceAng anatomical 2.506750e-04  0.2948752 0.9970512</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PaceAng.3  PaceAng   Residual 0.000000e+00  0.0000000 0.9970512</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Humberto G Ferrón.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

